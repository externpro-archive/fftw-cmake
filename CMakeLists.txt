cmake_minimum_required(VERSION 2.8.7)
project(fftw)
set(VER_MAJ 3)
set(VER_MIN 3)
set(VER_PT 3)
set(fftwroot ${fftw_SOURCE_DIR}/..)
get_filename_component(fftwroot ${fftwroot} ABSOLUTE)
set(precisions double float long-double)
foreach(prec ${precisions})
  set(BENCHFFT_LDOUBLE)
  set(FFTW_LDOUBLE)
  set(BENCHFFT_SINGLE)
  set(FFTW_SINGLE)
  # NOTE: QUAD not yet supported
  set(BENCHFFT_QUAD)
  set(FFTW_QUAD)
  if(${prec} MATCHES "float")
    set(BENCHFFT_SINGLE 1)
    set(FFTW_SINGLE 1)
    set(suffix ${VER_MAJ}f-${VER_MIN})
  elseif(${prec} MATCHES "long-double")
    set(BENCHFFT_LDOUBLE 1)
    set(FFTW_LDOUBLE 1)
    set(suffix ${VER_MAJ}l-${VER_MIN})
  elseif(${prec} MATCHES "double")
    set(suffix ${VER_MAJ}-${VER_MIN})
  endif()
  set(lib_name libfftw${suffix})
  set(lib_dir ${CMAKE_BINARY_DIR}/${lib_name})
  if(NOT EXISTS ${lib_dir})
    execute_process(COMMAND ${CMAKE_COMMAND} -E make_directory ${lib_dir})
  endif()
  include(config.h.cmake)
  configure_file(config.h.in ${lib_dir}/config.h)
  include(libfftw.cmake)
  get_directory_property(common_inc INCLUDE_DIRECTORIES)
  set_property(TARGET ${lib_name} PROPERTY INCLUDE_DIRECTORIES ${common_inc} ${lib_dir})
endforeach()
